# 🏛️ QuizDraw 개발 헌법 - 핵심 원칙

## 📜 제1조: 폴백/임시/더미 데이터 **절대금지**

### ⚖️ **최우선 원칙 (모든 지침보다 우선)**

```
🔥 제1항: 가짜 데이터 절대금지
- 하드코딩된 값 사용 절대 금지
- MOCK 데이터 사용 절대 금지  
- 임시 데이터 사용 절대 금지
- 더미 데이터 사용 절대 금지
- 폴백 데이터 사용 절대 금지
- 테스트용 고정값 사용 절대 금지

🔥 제2항: 실제 오류가 가짜 성공보다 낫다
- 차라리 오류가 나야 한다
- 실패는 빠르게, 명확하게, 소리나게
- 가짜 성공은 독이다
- MISSING_CONFIG로 명시적 실패 구현
```

### 🚨 **금지 패턴들**

```javascript
// 🚨 절대 금지
❌ const fallbackData = { coins: 100 }
❌ const mockRooms = [{ code: "AB12CD", status: "waiting" }]
❌ if (!response) return { success: true, data: dummyData }
❌ const defaultPalettes = TEMP_PALETTES
❌ || "기본값"
❌ // TODO: 나중에 실제 API 연결

// ✅ 올바른 방식  
✅ if (!supabaseUrl) throw new Error('MISSING_CONFIG: SUPABASE_URL')
✅ const response = await realAPI()
✅ if (!response.ok) throw new Error('API_ERROR: ' + response.message)
✅ return response.data // 실제 데이터만
```

---

## 📜 제2조: 전체 완결 구조 원칙

### ⚖️ **부분해결 금지, 전사적 완결만 승인**

```
🔥 제1항: 하나를 고치면 전부를 점검하라
- 단일 이슈 해결 시, 관련된 모든 계층을 즉시 동시 점검/수정
- Flutter앱, Supabase DB, Edge Functions, UI/UX까지 포함
- "대부분 해결"은 실패다. 100% 완결만을 해결로 인정

🔥 제2항: 연결된 전체 시스템 기준으로 승인
- 변경은 항상 시스템 전반(클라이언트↔Edge Functions↔DB)을 검증
- 어느 한 계층이라도 미반영/미검증이면 승인 불가
- 임시 우회, 하드코딩, 부분적 폴백 절대 금지
```

### 🎯 **완결 검증 체크리스트**

```
✅ 필수 검증 영역 (모두 통과해야만 "완결")

□ Flutter App (UI/상태관리/API연동/에러처리)
□ Supabase DB (스키마/RLS/트리거/인덱스)  
□ Edge Functions (비즈니스로직/SSV검증/Idempotency)
□ 사용자 경험 (빈상태/오류상태/로딩상태)
□ 보안 (인증/권한/데이터검증)
□ 성능 (쿼리최적화/캐시/로딩시간)
□ 에러 핸들링 (명확한 에러메시지/복구방법)
□ 테스트 (실제 플로우 검증)
□ 문서 (README/API문서 업데이트)

하나라도 빠지면 "미완결"로 간주
```

---

## 📜 제3조: 실수 정리 및 예방

### ⚖️ **성급한 판단 금지, 체계적 분석 의무**

```
🔥 제1항: 성급한 진단 절대금지
- 일부 파일만 보고 전체 시스템 판단 금지
- 표면적 관찰만으로 결론 도출 금지
- "대충 봐도 알겠다" 식 접근 금지
- 추측 금지, 증거 기반 판단만 허용

🔥 제2항: 체계적 분석 의무
- 전체 구조 파악 → 핵심 로직 확인 → 데이터 흐름 분석
- 실제 입출력 테스트로 동작 검증 필수
- 의존성과 연결점 모두 확인
- 문서화된 증거로 판단 근거 제시
```

### 🔍 **올바른 분석 순서**

```
1단계: 전체 구조 파악
- 프로젝트 디렉토리 전체 구조 분석
- 주요 모듈과 연결 관계 파악
- API 엔드포인트와 데이터 플로우 확인

2단계: 핵심 로직 확인  
- Edge Functions의 실제 비즈니스 로직 분석
- Supabase 테이블과 관계 확인
- Flutter에서 API 호출 방식 검증

3단계: 데이터 흐름 분석
- 사용자 입력 → 처리 → 저장 → 응답 전 과정 추적
- 실제 데이터 변환과 검증 로직 확인
- 에러 처리와 예외 상황 대응 확인

4단계: 통합 테스트
- 실제 사용자 시나리오로 end-to-end 테스트
- 각 기능의 실제 동작 검증
- 성능과 안정성 확인

5단계: 종합 판단
- 전체 시스템의 완전성 평가
- 미완성/문제점 명확히 식별
- 개선 방안 구체적 제시
```

---

## 📜 제4조: 실패 처리 원칙

### ⚖️ **명확한 실패 > 모호한 성공**

```
🔥 제1항: 명확한 실패 구현
- 문제 발생 시 즉시 명확한 에러 발생
- 에러 메시지는 구체적이고 해결 방향 제시
- 사용자에게 현재 상황 정확히 전달
- 조용한 실패나 무시 절대 금지

🔥 제2항: 복구 가능한 실패 설계
- 실패 시점에서 안전한 상태 유지
- 사용자가 재시도할 수 있는 명확한 방법 제공
- 시스템 상태를 오염시키지 않는 실패
- 로그와 디버깅 정보 충분히 제공
```

### 🎯 **실패 처리 패턴**

```dart
// ✅ Flutter에서 올바른 실패 처리
try {
  final result = await supabase
    .from('rooms')
    .insert(roomData);
  
  if (result.error != null) {
    throw Exception('방 생성 실패: ${result.error!.message}');
  }
  
  return result.data;
} catch (e) {
  // 사용자에게 명확한 메시지 표시
  showErrorDialog('방을 생성할 수 없습니다. 인터넷 연결을 확인하고 다시 시도해주세요.');
  rethrow; // 상위에서도 처리할 수 있도록
}
```

```typescript
// ✅ Edge Function에서 올바른 실패 처리
export default async function handler(req: Request) {
  try {
    const { roomCode } = await req.json();
    
    if (!roomCode) {
      return new Response(
        JSON.stringify({ error: 'MISSING_ROOM_CODE' }), 
        { status: 400 }
      );
    }
    
    // 실제 비즈니스 로직
    const result = await processRoom(roomCode);
    
    return new Response(JSON.stringify(result));
  } catch (error) {
    console.error('Room processing failed:', error);
    return new Response(
      JSON.stringify({ 
        error: 'ROOM_PROCESSING_FAILED',
        message: error.message 
      }), 
      { status: 500 }
    );
  }
}
```

---

## 🚨 **위반 시 즉시 대응 절차**

### **1. 즉시 중단 프로토콜**

```
🚨 폴백/임시/더미 데이터 발견 시:
1. 즉시 작업 중단
2. 위반 코드 식별 및 제거
3. 실제 데이터 연결 방법 구현
4. MISSING_CONFIG 패턴으로 명확한 실패 구현

🚨 부분 완결 감지 시:
1. 즉시 작업 중단 및 범위 재정의
2. 누락된 계층 식별 및 보완 계획 수립
3. 전체 시스템 동시 반영
4. 완전한 end-to-end 테스트 수행

🚨 성급한 판단 발견 시:
1. 즉시 분석 중단
2. 체계적 5단계 분석 순서 적용
3. 증거 기반 재분석 수행
4. 정정된 결과 문서화
```

### **2. 위반 보고 양식**

```
🚨 개발 헌법 위반 감지!

위반 유형: [폴백데이터/부분완결/성급판단] 중 선택
위반 내용: [구체적인 위반 사항]
발견 위치: [파일명과 라인/함수명]
위반 이유: [왜 문제인지 설명]

수정 방안:
1. [구체적인 해결 방법]
2. [전체 시스템 영향도]
3. [테스트 계획]
4. [재발 방지 책]
```

---

## 🛡️ **개발 시 필수 체크리스트**

### **✅ 코드 작성 전**

```
□ 실제 API/DB 연결 계획 수립
□ 에러 처리 방안 설계
□ 전체 시스템 영향도 분석
□ 테스트 시나리오 준비
□ 문서 업데이트 계획
```

### **✅ 코드 작성 중**

```
□ 하드코딩/더미 데이터 사용 금지
□ 실제 Supabase 연결 구현
□ 명확한 에러 메시지 작성
□ Edge Function 비즈니스 로직 구현
□ Flutter 상태 관리 정확히 구현
```

### **✅ 코드 완성 후**

```
□ end-to-end 테스트 완료
□ 모든 에러 상황 테스트
□ 성능 최적화 확인
□ 보안 검증 완료
□ 문서 업데이트 완료
□ 다른 개발자 리뷰 완료
```

---

## 🔥 **핵심 철학 요약**

### **"실패는 성공의 어머니, 가짜 성공은 실패의 독"**

```
💎 원칙 1: 명확한 실패 > 모호한 성공
💎 원칙 2: 실제 구현 > 임시 방편  
💎 원칙 3: 전체 완결 > 부분 해결
💎 원칙 4: 체계적 분석 > 성급한 판단
💎 원칙 5: 증거 기반 > 추측 기반
💎 원칙 6: 사용자 중심 > 개발 편의
```

---

## ⚡ **예외 없음 선언**

```
🚨 이 헌법에는 예외가 없습니다
🚨 "임시로만", "테스트용으로만"도 금지입니다  
🚨 "나중에 고칠게요"도 금지입니다
🚨 "일단 돌아가게만"도 금지입니다
🚨 "부분적으로 완성"도 금지입니다
🚨 "대충 봐도 알겠다"도 금지입니다

💪 지금 당장 올바르고 완전하게 하거나, 아예 하지 마라!
💪 지금 당장 체계적으로 분석하거나, 아예 판단하지 마라!
```

---

## 🎯 **최종 다짐**

### **"QuizDraw는 사용자가 실제로 사용하는 완전한 앱이 되어야 한다"**

- 모든 기능이 실제로 작동해야 함
- 사용자 경험이 부드럽고 직관적이어야 함  
- 오류 상황도 명확하고 친화적으로 처리
- 성능과 보안이 실서비스 수준이어야 함
- 개발 과정도 체계적이고 지속가능해야 함

### **"개발 헌법 위반은 즉시 중단한다"**

- 헌법 위반 발견 시 모든 작업 즉시 중단
- 변명이나 예외 요청 불허  
- 올바른 방식으로 처음부터 다시 시작
- 완전한 해결만이 유일한 성공 기준

---

## 🏛️ **헌법 서명**

```
이 QuizDraw 개발 헌법은 프로젝트의 모든 개발 작업에서 
절대적으로 준수되어야 하는 최우선 원칙입니다.

적용 프로젝트: QuizDraw (너랑 나의 그림퀴즈)
버전: v1.0  
효력: 즉시 발효, 프로젝트 완료까지 유효
목표: 사용자가 실제로 사용하는 완전한 앱 구현
```

---

**🔥 기억하라: 가짜 데이터는 독이고, 부분 완결은 실패, 성급한 판단은 오판이다! 🔥**